#:include password.kv
#:include log.kv
#:include fables.kv
#:include qrcodes.kv

<JdpGrid>
    FloatLayout:
        Image:
            id: map
            pos: 0, 0
            source: './resources/images/empty_map_buttons.png'
            allow_stretch: True

        Widget:
            PopupBttn:
                id: plaine
                id_name: 'plaine'
                name: 'plaine'
                text: ''
                font_size: 100
                color: 255, 255, 255, 1
                pos: 900, root.height - 660
                size: 380, 220
                on_press: self.open_popup()
                background_color: 0, 0, 0, 0.5

            PopupBttn:
                id: montagne
                id_name: 'montagne'
                name: 'montagne'
                text: ''

                pos: 1020, root.height - 900
                size: 200, 230
                on_press: self.open_popup()
                background_color: 0, 0, 0, 0.5

            PopupBttn:
                id: jungle
                id_name: 'jungle'
                name: 'jungle'
                text: ''

                pos: 1230, root.height - 870
                size: 220, 240
                on_press: self.open_popup()
                background_color: 0, 0, 0, 0.5

            PopupBttn:
                id: ciel
                id_name: 'ciel'
                name: 'ciel'
                text: ''

                pos: 760, root.height - 380
                size: 190, 135
                on_press: self.open_popup()
                background_color: 0, 0, 0, 0.5

            PopupBttn:
                id: marais
                id_name: 'marais'
                name: 'marais'
                text: ''

                pos: 950, root.height - 360
                size: 300, 175
                on_press: self.open_popup()
                background_color: 0, 0, 0, 0.5

            PopupBttn:
                id: fontaine
                id_name: 'fontaine'
                name: 'fontaine'
                text: ''

                pos: 1255, root.height - 230
                size: 235, 175
                on_press: self.open_popup()
                background_color: 0, 0, 0, 0.5

            PopupBttn:
                id: jardin
                id_name: 'jardin'
                name: 'jardin'
                text: ''

                pos: 390, root.height - 480
                size: 325, 185
                on_press: self.open_popup()
                background_color: 0, 0, 0, 0.5

            PopupBttn:
                id: ville
                id_name: 'ville'
                name: 'ville'
                text: ''

                pos: 780, root.height - 770
                size: 235, 125
                on_press: self.open_popup()
                background_color: 0, 0, 0, 0.5

            PopupBttn:
                id: remparts
                id_name: 'remparts'
                name: 'remparts'
                text: ''

                pos: 580, root.height - 890
                size: 400, 125
                on_press: self.open_popup()
                background_color: 0, 0, 0, 0.5

            Button:
                id: qrcodebutton
                size: 128, 128
                pos: root.width - 128, 10
                disabled: True
                background_normal: './resources/images/qrcode_icon.png'
                background_down: './resources/images/qrcode_icon_pressed.png'
                background_disabled_normal: './resources/images/past_disabled.png'
                on_press:
                    root.manager.transition.direction = "left"
                    root.manager.transition.duration = 0
                    root.manager.current = "qrcode"

            Button:
                size: 128, 128
                pos: root.width - 268, 10
                background_normal: './resources/images/pass_icon.png'
                background_down: './resources/images/pass_icon_pressed.png'
                on_press:
                    root.manager.transition.direction = "right"
                    root.manager.transition.duration = 0
                    root.manager.current = "pass"


            Button:
                size: 128, 128
                pos: root.width - 128, 300
                background_normal: './resources/images/quill.png'
                background_down: './resources/images/quill.png'
                on_press:
                    root.manager.transition.direction = "up"
                    root.manager.transition.duration = 0.1
                    root.manager.current = "log"

# Bouton Fables
#            Button:
#                size: 128, 128
#                pos: root.width - 128, 170
#                background_normal: './resources/images/book.png'
#                background_down: './resources/images/book.png'
#                on_press:
#                    root.manager.transition.direction = "down"
#                    root.manager.transition.duration = 0.1
#                    root.manager.current = "fables"

            Button:
                size: 128, 128
                pos: 10, 10
                background_normal: './resources/images/settings_icon.png'
                background_down: './resources/images/settings_icon_pressed.png'
                on_press: root.reinit_popup()

            Button:
                id: lievrebutton
                size: 128, 128
                pos: 10, 170
                disabled: True
                #background_color: 0, 0, 0, 0
                background_normal: './resources/images/clock.png'
                background_down: './resources/images/clock.png'
                background_disabled_normal: './resources/images/past_disabled.png'

                on_press:
                    root.manager.transition.direction = "down"
                    root.manager.transition.duration = 0.1
                    root.manager.current = "lievre"

            Button:
                id: dessinbutton
                size: 128, 128
                pos: 10, 320
                disabled: True
                #background_color: 0, 0, 0, 0
                background_normal: './resources/images/compass.png'
                background_down: './resources/images/compass.png'
                background_disabled_normal: './resources/images/past_disabled.png'
                on_press:
                    root.manager.transition.direction = "down"
                    root.manager.transition.duration = 0.1
                    root.manager.current = "dessin"

# pastilles avancement
            Button:
                id: enigme_1
                size: 128, 128
                pos: 30, root.height - 150
                disabled: True
                background_normal: './resources/images/past_rouge.png'
                background_down: './resources/images/past_rouge.png'
                background_disabled_normal: './resources/images/past_disabled.png'

            Button:
                id: enigme_2
                size: 128, 128
                pos: 130, root.height - 150
                disabled: True
                background_normal: './resources/images/past_orange.png'
                background_down: './resources/images/past_orange.png'
                background_disabled_normal: './resources/images/past_disabled.png'

            Button:
                id: enigme_3
                size: 128, 128
                pos: 230, root.height - 150
                disabled: True
                background_normal: './resources/images/past_jaune.png'
                background_down: './resources/images/past_jaune.png'
                background_disabled_normal: './resources/images/past_disabled.png'

            Button:
                id: enigme_4
                size: 128, 128
                pos: 330, root.height - 150
                disabled: True
                background_normal: './resources/images/past_vert.png'
                background_down: './resources/images/past_vert.png'
                background_disabled_normal: './resources/images/past_disabled.png'

            Button:
                id: enigme_5
                size: 128, 128
                pos: 430, root.height - 150
                disabled: True
                background_normal: './resources/images/past_bleu.png'
                background_down: './resources/images/past_bleu.png'
                background_disabled_normal: './resources/images/past_disabled.png'

            Button:
                id: enigme_6
                size: 128, 128
                pos: 530, root.height - 150
                disabled: True
                background_normal: './resources/images/past_indigo.png'
                background_down: './resources/images/past_indigo.png'
                background_disabled_normal: './resources/images/past_disabled.png'

            Button:
                id: enigme_7
                size: 128, 128
                pos: 630, root.height - 150
                disabled: True
                background_normal: './resources/images/past_violet.png'
                background_down: './resources/images/past_violet.png'
                background_disabled_normal: './resources/images/past_disabled.png'


            Time:
                text:root.t.text
                pos: root.width/2 - 50, 0
                font_size: 40


<ReinitPopup>:
	GridLayout:
		cols: 1
		padding: '12dp'
		size_hint_x: 0.66
		size_hint_y: 0
		height: self.minimum_height

		canvas:
			Color:
				rgba: root.background_color[:3] + [root.background_color[-1] * root._anim_alpha]
			Rectangle:
				size: root._window.size if root._window else (0, 0)

			Color:
				rgb: 1, 1, 1
			BorderImage:
				source: root.background
				border: root.border
				pos: self.pos
				size: self.size

		BoxLayout:
			size_hint_y: None
			height: sp(48)

			Button:
				text: root.cancel_text
				on_press: root.cancel()
			Button:
				text: root.ok_text
				on_press: root.ok()

<ChooseLocPopup>:
    title: 'Quel est cet endroit ?'

# Pour faire des boutons :
    GridLayout:
        col: 3
        rows: 3
        Button:
            text: 'plaine'
            on_release: root.check_status(self.text)
            on_release: root.dismiss()
        Button:
            text: 'montagne'
            on_release: root.check_status(self.text)
            on_release: root.dismiss()
        Button:
            text: 'fontaine'
            on_release: root.check_status(self.text)
            on_release: root.dismiss()
        Button:
            text: 'jungle'
            on_release: root.check_status(self.text)
            on_release: root.dismiss()
        Button:
            text: 'ville'
            on_release: root.check_status(self.text)
            on_release: root.dismiss()
        Button:
            text: 'marais'
            on_release: root.check_status(self.text)
            on_release: root.dismiss()
        Button:
            text: 'ciel'
            on_release: root.check_status(self.text)
            on_release: root.dismiss()
        Button:
            text: 'remparts'
            on_release: root.check_status(self.text)
            on_release: root.dismiss()
        Button:
            text: 'jardin'
            on_release: root.check_status(self.text)
            on_release: root.dismiss()


#        BoxLayout:
#            size_hint_y: None
#            height: sp(48)

#            Button:
#                text: root.ok_text
#                on_press: root.ok()

#            Button:
#                text: root.cancel_text
#                on_press: root.cancel()


# Fonctionnement en textinput
#        TextInput:
#            id: text_input
#            hint_text:'Entrer le lieu'
#            pos_hint: {'center_x': 0.5, 'center_y': 0.705}
#            size_hint: 0.95, 0.5
#            multiline: False
#            on_text_validate : root.ok()

#    BoxLayout:
#        text_input: text_input
#        size_hint_y: 0.9
#        size_hiny_x: 0.9
#        orientation : 'vertical'